<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>
        Threezh1&#39;Blog
    </title>
    
<link rel="stylesheet" href="/libs/highlight/styles/monokai-sublime.css">

    
<link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">

    
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.2.0"></head>

<body id="bodyx">
    <div class="hd posts">
    <a href="/index.html"><i class="fa fa-reply replay-btn" aria-hidden="true"></i></a>
    <div class="post-title">
        <p>
            Vulnerability-goapp-Go语言漏洞平台审计过程
        </p>
        <hr>
    </div>
    <div class="post-content">
        <!--Table of Contents begin-->
        
            <div id="toc" class="toc-article">
            <strong class="toc-title">目录</strong>
            <a class="js-toggle-toc" href="javascript:void(0)"></a>
            <div class="toc-content">
                <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%86%9F%E6%82%89%E6%9E%B6%E6%9E%84"><span class="toc-text">熟悉架构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84"><span class="toc-text">文件结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E4%B8%AA%E9%A1%B5%E9%9D%A2%E7%9A%84%E6%B8%B2%E6%9F%93%E8%BF%87%E7%A8%8B"><span class="toc-text">一个页面的渲染过程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XSS"><span class="toc-text">XSS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A6%96%E9%A1%B5%E5%8F%8D%E5%B0%84%E5%9E%8BXSS"><span class="toc-text">首页反射型XSS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E5%86%8C%E5%A4%84%E5%82%A8%E5%AD%98%E5%9E%8BXSS"><span class="toc-text">注册处储存型XSS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8E%E5%8F%B0Profile%E5%A4%84%E5%A4%9A%E4%B8%AA%E5%82%A8%E5%AD%98%E5%9E%8BXSS"><span class="toc-text">后台Profile处多个储存型XSS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8E%E5%8F%B0TimeLine%E5%A4%84%E5%82%A8%E5%AD%98%E5%9E%8BXSS%E6%BC%8F%E6%B4%9E"><span class="toc-text">后台TimeLine处储存型XSS漏洞</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL%E6%B3%A8%E5%85%A5"><span class="toc-text">SQL注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8E%E5%8F%B0TimeLine%E6%90%9C%E7%B4%A2%E5%A4%84%E5%AD%98%E5%9C%A8SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E"><span class="toc-text">后台TimeLine搜索处存在SQL注入漏洞</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-text">任意文件上传</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8E%E5%8F%B0%E5%A4%B4%E5%83%8F%E4%B8%8A%E4%BC%A0%E5%A4%84%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E"><span class="toc-text">后台头像上传处存在任意文件上传漏洞</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-text">命令执行</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%A1%E7%90%86%E5%91%98%E5%90%8E%E5%8F%B0%E5%A4%84%E5%AD%98%E5%9C%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E"><span class="toc-text">管理员后台处存在命令执行漏洞</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CSRF%E6%BC%8F%E6%B4%9E"><span class="toc-text">CSRF漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8E%E5%8F%B0%E5%A4%9A%E5%A4%84%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E"><span class="toc-text">后台多处存在CSRF漏洞</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-text">参考</span></a></li></ol>
            </div>
            </div>
        
        <!--Table of Contents end -->
        <p>平台的漏洞是比较偏基础的，很多内容都是简单傻瓜式的漏洞。但尽管如此，这个平台用来了解go语言的web流程还是可以的。</p>
<p>项目地址：<a target="_blank" rel="noopener" href="https://github.com/Snow-HardWolf/Vulnerability-goapp">Vulnerability-goapp</a></p>
<p>Ps：项目中的docker环境我搭不起来，总是报错。所以是直接把源码下载到本机windows环境下自己改了源码搭的。</p>
<a id="more"></a>

<h2 id="熟悉架构"><a href="#熟悉架构" class="headerlink" title="熟悉架构"></a>熟悉架构</h2><h3 id="文件结构"><a href="#文件结构" class="headerlink" title="文件结构"></a>文件结构</h3><p>一些比较重要的文件夹与文件：</p>
<ul>
<li>pkg        平台各功能的源码都在这个目录</li>
<li>views     html模板目录</li>
<li>main.go 主程序</li>
</ul>
<p>/<code>login</code>页面：</p>
<p><img src="https://i.loli.net/2020/02/21/Y8GmtaqyDexbTMC.png" alt="04.png"></p>
<h3 id="一个页面的渲染过程"><a href="#一个页面的渲染过程" class="headerlink" title="一个页面的渲染过程"></a>一个页面的渲染过程</h3><p>主程序先从pkg中引入各功能模块</p>
<p><img src="https://i.loli.net/2020/02/21/qrMtw8oUd46iFyW.png" alt="02.png"></p>
<p>在main函数中定义路由，可以从这里通过功能定位函数</p>
<p><img src="https://i.loli.net/2020/02/21/axkisTIqN2WtCLy.png" alt="03.png"></p>
<p>以<code>/login</code>页面为例，对应的函数是login.Login。跟踪到<code>pkg/login/login.go</code>。然后来看下这个函数的整个过程是怎么样的。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Login</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123; <span class="comment">// r为请求对象，w为返回对象</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;method &quot;</span>, r.Method) <span class="comment">// 通过r.Method获取请求的方式</span></span><br><span class="line">	<span class="keyword">if</span> r.Method == <span class="string">&quot;GET&quot;</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> cookie.CheckSessionID(r) &#123; <span class="comment">// 通过CheckSessionID函数检查是否登录</span></span><br><span class="line">			http.Redirect(w, r, <span class="string">&quot;/top&quot;</span>, <span class="number">302</span>) <span class="comment">// 登录了就直接跳转到top</span></span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			t, _ := template.ParseFiles(<span class="string">&quot;./views/public/login.gtpl&quot;</span>) <span class="comment">// 读入模板文件</span></span><br><span class="line">			t.Execute(w, <span class="literal">nil</span>) <span class="comment">// 模板解析并返回</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> r.Method == <span class="string">&quot;POST&quot;</span> &#123;</span><br><span class="line">        r.ParseForm() <span class="comment">// 解析获取到的数据，GET/POST解析都要有这个语句才能使用r.Form[]</span></span><br><span class="line">		<span class="keyword">if</span> isZeroString(r.FormValue(<span class="string">&quot;mail&quot;</span>)) &amp;&amp; isZeroString(r.FormValue(<span class="string">&quot;passwd&quot;</span>)) &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;passwd&quot;</span>, r.Form[<span class="string">&quot;passwd&quot;</span>])</span><br><span class="line">			fmt.Println(<span class="string">&quot;mail&quot;</span>, r.Form[<span class="string">&quot;mail&quot;</span>])</span><br><span class="line">            <span class="comment">// r.FormValue和r.Form的区别是前者只获取同名的第一个数据值，后者会返回一个slice(数组形式)</span></span><br><span class="line">			mail := r.FormValue(<span class="string">&quot;mail&quot;</span>)</span><br><span class="line">			id := SearchID(mail) <span class="comment">// 通过邮箱获取一个用户id</span></span><br><span class="line">			<span class="keyword">if</span> id != <span class="number">0</span> &#123; </span><br><span class="line">				passwd := r.FormValue(<span class="string">&quot;passwd&quot;</span>)</span><br><span class="line">				name := CheckPasswd(id, passwd) <span class="comment">// 验证密码</span></span><br><span class="line">				<span class="keyword">if</span> name != <span class="string">&quot;&quot;</span> &#123; <span class="comment">// 如果登录成功</span></span><br><span class="line">					fmt.Println(name) </span><br><span class="line">					t, _ := template.ParseFiles(<span class="string">&quot;./views/public/logined.gtpl&quot;</span>) <span class="comment">// 读入logined.gtpl模板</span></span><br><span class="line">					encodeMail := base64.StdEncoding.EncodeToString([]<span class="keyword">byte</span>(mail))</span><br><span class="line">					fmt.Println(encodeMail)</span><br><span class="line">					cookieSID := &amp;http.Cookie&#123;</span><br><span class="line">						Name:  <span class="string">&quot;SessionID&quot;</span>,</span><br><span class="line">						Value: encodeMail,</span><br><span class="line">					&#125;</span><br><span class="line">					cookieUserName := &amp;http.Cookie&#123;</span><br><span class="line">						Name:  <span class="string">&quot;UserName&quot;</span>,</span><br><span class="line">						Value: name,</span><br><span class="line">					&#125;</span><br><span class="line">					StoreSID(id, encodeMail)</span><br><span class="line">					http.SetCookie(w, cookieUserName)</span><br><span class="line">					http.SetCookie(w, cookieSID)</span><br><span class="line">                    <span class="comment">// 以上部分是设置Cookies</span></span><br><span class="line">					p := Person&#123;UserName: name&#125; <span class="comment">// 这里定义了p，传递到模板中进行解析</span></span><br><span class="line">					t.Execute(w, p) <span class="comment">// 模板解析</span></span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					fmt.Println(name)</span><br><span class="line">					t, _ := template.ParseFiles(<span class="string">&quot;./views/public/error.gtpl&quot;</span>)</span><br><span class="line">					t.Execute(w, <span class="literal">nil</span>)</span><br><span class="line">				&#125;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				t, _ := template.ParseFiles(<span class="string">&quot;./views/public/error.gtpl&quot;</span>)</span><br><span class="line">				t.Execute(w, <span class="literal">nil</span>)</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;username or passwd are empty&quot;</span>)</span><br><span class="line">			outErrorPage(w)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		http.NotFound(w, <span class="literal">nil</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果登录成功，<code>p := Person&#123;UserName: name&#125;</code> p传递到了模板中，再来看下<code>/views/public/logined.gtpl</code>模板是怎么解析的：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;ja&quot;</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Required meta tags --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1, shrink-to-fit=no&quot;</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">&lt;!-- Bootstrap CSS --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css&quot;</span> <span class="attr">integrity</span>=<span class="string">&quot;sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO&quot;</span> <span class="attr">crossorigin</span>=<span class="string">&quot;anonymous&quot;</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Login successful!<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;./assets/css/style.css&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;center&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;display-1 text-center&quot;</span>&gt;</span>Login successful !!!!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;display-1 text-center&quot;</span>&gt;</span>Welcome , &#123;&#123;.UserName&#125;&#125; !!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/top&quot;</span>&gt;</span>Top Page<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>可以看到，这里使用了模板来读取p中的UserName的值并将其替换。最终作为返回数据返回。所以在传递到模板之后只会进行替换，不会进行转义或其他过滤操作。</p>
<h2 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h2><h3 id="首页反射型XSS"><a href="#首页反射型XSS" class="headerlink" title="首页反射型XSS"></a>首页反射型XSS</h3><p>漏洞点源码：main.go</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sayYourName</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">	r.ParseForm()</span><br><span class="line">	fmt.Println(r.Form)</span><br><span class="line">	fmt.Println(<span class="string">&quot;path&quot;</span>, r.URL.Path)</span><br><span class="line">	fmt.Println(<span class="string">&quot;scheme&quot;</span>, r.URL.Scheme)</span><br><span class="line">	fmt.Println(<span class="string">&quot;r.Form&quot;</span>, r.Form)</span><br><span class="line">	fmt.Println(<span class="string">&quot;r.Form[name]&quot;</span>, r.Form[<span class="string">&quot;name&quot;</span>])</span><br><span class="line">	<span class="keyword">var</span> Name <span class="keyword">string</span></span><br><span class="line">	<span class="keyword">for</span> k, v := <span class="keyword">range</span> r.Form &#123; <span class="comment">// 循环获取GET与POST参数与参数值</span></span><br><span class="line">		fmt.Println(<span class="string">&quot;key:&quot;</span>, k)</span><br><span class="line">		Name = strings.Join(v, <span class="string">&quot;,&quot;</span>) <span class="comment">// 将多个定义的参数进行拼接</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(Name)</span><br><span class="line">	fmt.Fprintf(w, Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>访问主页就是调用的<code>sayYourName</code>，可以看到最后返回的是Name的内容，Name是在for循环当中，将最后一个参数赋值得到的。(如果参数有多个定义，则会使用”,”连接) 传递期间并没有进行过滤，所以造成xss漏洞。</p>
<p>POC：<a target="_blank" rel="noopener" href="http://127.0.0.1/?test=%3Cscript%3Ealert(%22Threezh1%22)%3C/script%3E">http://127.0.0.1/?test=%3Cscript%3Ealert(%22Threezh1%22)%3C/script%3E</a></p>
<h3 id="注册处储存型XSS"><a href="#注册处储存型XSS" class="headerlink" title="注册处储存型XSS"></a>注册处储存型XSS</h3><p>注册处源码：pkg/register/register.go</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">RegisterUser</span><span class="params">(r *http.Request)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">	db, err := sql.Open(<span class="string">&quot;mysql&quot;</span>, <span class="string">&quot;root:root@tcp(127.0.0.1:3306)/vulnapp&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Fatal(err)</span><br><span class="line">	&#125;</span><br><span class="line">	age, err := strconv.Atoi(r.FormValue(<span class="string">&quot;age&quot;</span>))</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(err)</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line">	_, err = db.Exec(<span class="string">&quot;insert into user (name,mail,age,passwd) value(?,?,?,?)&quot;</span>, r.FormValue(<span class="string">&quot;name&quot;</span>), r.FormValue(<span class="string">&quot;mail&quot;</span>), age, r.FormValue(<span class="string">&quot;passwd&quot;</span>)) <span class="comment">// value值都是从FormValue当中获取的</span></span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(err)</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>从源码中可以知道，插入到数据库的数据是直接从表单提交的数据中获取的。期间并没有经过过滤。虽然经过了一个换位符的处理，但是对xss的payload起不到过滤的效果。</p>
<p>注册时使用用户名：<code>test&lt;script&gt;alert(1)&lt;/script&gt;</code> 登录后即可弹窗</p>
<h3 id="后台Profile处多个储存型XSS"><a href="#后台Profile处多个储存型XSS" class="headerlink" title="后台Profile处多个储存型XSS"></a>后台Profile处多个储存型XSS</h3><p>后台Profile处可以修改个人信息，Name、Address、Favorite Animal、Word三处内容都可以造成储存型XSS。</p>
<p>pkg/user/usermanager.go：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">UpdateUserDetails</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line"><span class="comment">// 部分源码经过省略</span></span><br><span class="line">    _, err = db.Exec(<span class="string">&quot;insert into vulnapp.userdetails (uid,userimage,address,animal,word) values (?,?,?,?,?)&quot;</span>, uid, <span class="string">&quot;noimage.png&quot;</span>, address, animal, word)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Printf(<span class="string">&quot;%+v\n&quot;</span>, err)</span><br><span class="line">        http.NotFound(w, <span class="literal">nil</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 部分源码经过省略</span></span><br></pre></td></tr></table></figure>

<p>原因跟注册处的储存型XSS一样，都是没有经过严格的过滤而导致的。</p>
<p>复现：直接将内容修改为XSS Payload即可</p>
<h3 id="后台TimeLine处储存型XSS漏洞"><a href="#后台TimeLine处储存型XSS漏洞" class="headerlink" title="后台TimeLine处储存型XSS漏洞"></a>后台TimeLine处储存型XSS漏洞</h3><p>TimeLine是一个类似于留言板的地方，而传入留言板的内容也没有经过过滤直接储存到数据库内。最后渲染出来造成XSS漏洞。</p>
<p>pkg/post/post.go：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ShowAddPostPage</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">	<span class="keyword">if</span> r.Method == <span class="string">&quot;GET&quot;</span> &#123;</span><br><span class="line">		<span class="comment">// 代码经过省略</span></span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> r.Method == <span class="string">&quot;POST&quot;</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> cookie.CheckSessionID(r) &#123;</span><br><span class="line">			<span class="comment">// 代码经过省略</span></span><br><span class="line">			postText := r.FormValue(<span class="string">&quot;post&quot;</span>)</span><br><span class="line">			fmt.Println(reflect.TypeOf(postText))</span><br><span class="line">			StorePost(uid, postText) <span class="comment">// 传递到这</span></span><br><span class="line">			http.Redirect(w, r, <span class="string">&quot;/post&quot;</span>, <span class="number">301</span>)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		http.NotFound(w, <span class="literal">nil</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>跟踪<code>StorePost()</code>：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">StorePost</span><span class="params">(uid <span class="keyword">int</span>, postText <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line">	db, err := sql.Open(<span class="string">&quot;mysql&quot;</span>, <span class="string">&quot;root:root@tcp(127.0.0.1:3306)/vulnapp&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;%+v\n&quot;</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">defer</span> db.Close()</span><br><span class="line"></span><br><span class="line">	_, err = db.Exec(<span class="string">&quot;insert into vulnapp.posts(uid,post) values (?,?)&quot;</span>, uid, postText) <span class="comment">// 前面都没有经过过滤</span></span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;%+v\n&quot;</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>原因跟前面的XSS一样，都是没有经过严格的过滤而导致的。</p>
<p>复现：在文本框中输入XSS Payload即可</p>
<h2 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h2><p>在这个系统当中，大部分传递SQL语句是这样传递的：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> err := db.QueryRow(<span class="string">&quot;select id from user where mail=?&quot;</span>, mail).Scan(&amp;userID); err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;no set :&quot;</span>, err)</span><br><span class="line">&#125;</span><br><span class="line">log.Println(userID)</span><br></pre></td></tr></table></figure>

<p>语句的”?”相当于一个占位符，将第二个参数mail替换过去。而替换过去的mail会被转义。相当于经过了一次<code>addslashes()</code>处理。</p>
<p>比如我给mail定义：<code>makefoxm@qq.com&#39; and if(1=1,sleep(5),1)#</code> 那最终会被执行的SQL语句如下：</p>
<p><code>select id from user where mail=&#39;makefoxm@qq.com\&#39; and if(1=1,sleep(5),1)#&#39;</code></p>
<p>所以，如果要去寻找SQL注入漏洞的话，就得去寻找没有过滤并且是字符串之间直接拼接的点。</p>
<h3 id="后台TimeLine搜索处存在SQL注入漏洞"><a href="#后台TimeLine搜索处存在SQL注入漏洞" class="headerlink" title="后台TimeLine搜索处存在SQL注入漏洞"></a>后台TimeLine搜索处存在SQL注入漏洞</h3><p>pkg/search/search.go：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SearchPosts</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">	<span class="keyword">if</span> r.Method == <span class="string">&quot;POST&quot;</span> &#123;</span><br><span class="line">		searchWord := r.FormValue(<span class="string">&quot;post&quot;</span>)</span><br><span class="line">		fmt.Println(<span class="string">&quot;value : &quot;</span>, searchWord)</span><br><span class="line">		testStr := <span class="string">&quot;mysql -h 127.0.0.1 -u root -proot -e &#x27;select post,created_at from vulnapp.posts where post like \&quot;%&quot;</span> + searchWord + <span class="string">&quot;%\&quot;&#x27;&quot;</span></span><br><span class="line">		fmt.Println(testStr)</span><br><span class="line">		testres, err := exec.Command(<span class="string">&quot;sh&quot;</span>, <span class="string">&quot;-c&quot;</span>, testStr).Output()</span><br><span class="line">		<span class="comment">// 部分源码经过省略</span></span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		http.NotFound(w, <span class="literal">nil</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>从testStr赋值处可以看到，这里的SQL语句是直接用<code>+</code>进行拼接的，没有使用”?”进行替换。所以这里能够直接构造Payload进行SQL注入。</p>
<p>复现：TimeLine搜索内容：<code>123%&quot; and if(sleep(5),1,1)#</code> 页面延迟，构造其他语句就可以进一步进行利用。</p>
<h2 id="任意文件上传"><a href="#任意文件上传" class="headerlink" title="任意文件上传"></a>任意文件上传</h2><h3 id="后台头像上传处存在任意文件上传漏洞"><a href="#后台头像上传处存在任意文件上传漏洞" class="headerlink" title="后台头像上传处存在任意文件上传漏洞"></a>后台头像上传处存在任意文件上传漏洞</h3><p>在后台Profile处可以上传头像，但是对文件名及文件内容没有经过过滤。导致任意任意文件上传。具体代码如下：</p>
<p>pkg/image/imageUploader.go</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">UploadImage</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">	<span class="keyword">if</span> r.Method == <span class="string">&quot;POST&quot;</span> &#123;</span><br><span class="line">		<span class="comment">// 部分源码经过省略 </span></span><br><span class="line">		<span class="keyword">if</span> cookie.CheckSessionID(r) &#123;</span><br><span class="line">			file, handler, err := r.FormFile(<span class="string">&quot;uploadfile&quot;</span>)  <span class="comment">// 获取文件数据</span></span><br><span class="line">			<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">				fmt.Printf(<span class="string">&quot;%+v\n&quot;</span>, err)</span><br><span class="line">				<span class="keyword">return</span></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">defer</span> file.Close() </span><br><span class="line">			f, err := os.OpenFile(<span class="string">&quot;./assets/img/&quot;</span>+handler.Filename, os.O_WRONLY|os.O_CREATE, <span class="number">0666</span>)</span><br><span class="line">            <span class="comment">// 创建一个文件</span></span><br><span class="line">			<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">				fmt.Printf(<span class="string">&quot;%+v\n&quot;</span>, err)</span><br><span class="line">				<span class="keyword">return</span></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">defer</span> f.Close()</span><br><span class="line">			io.Copy(f, file) <span class="comment">// 将获取到的文件数据写入到本地创建的那个文件中去</span></span><br><span class="line">			UpdateDatabase(r, handler.Filename) <span class="comment">// 更新数据库中的用户信息</span></span><br><span class="line">            http.Redirect(w, r, <span class="string">&quot;/profile&quot;</span>, <span class="number">301</span>)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		http.NotFound(w, <span class="literal">nil</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>漏洞复现：直接用Brupsuite抓包可以修改上传的地址。</p>
<p>问题来了，怎么进行Getshell呢？Go语言跟PHP不太一样，它没有类似一句话这样的“工具”。并且要通过路由定义才能够通过web访问到。我最初的想法是能不能覆盖一个路由中已有的函数文件，通过修改函数中的语句来达到命令执行的效果。但在参考文章中有一个的方式更加方便，就是通过修改crontabs定时任务来进行利用。如图：</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/qq5rfBadR3ibU55LFTc2cC3zEvgacWF6WzH9wRV25ZhGCMksUEeiaZXMhyjYoXzPYdh9Umbn2xaJSgu5Qj5FYmxw/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="images"></p>
<p>(图片取自参考文章内)</p>
<p>这次搭建的题目环境是windows，配置linux环境太麻烦，就不复现了(怕了配置环境)。</p>
<h2 id="命令执行"><a href="#命令执行" class="headerlink" title="命令执行"></a>命令执行</h2><h3 id="管理员后台处存在命令执行漏洞"><a href="#管理员后台处存在命令执行漏洞" class="headerlink" title="管理员后台处存在命令执行漏洞"></a>管理员后台处存在命令执行漏洞</h3><p>首先来看<code>pkg/admin/admin.go</code>中的ShowAdminPage函数</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ShowAdminPage</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">	<span class="keyword">if</span> r.Method == <span class="string">&quot;GET&quot;</span> &#123;</span><br><span class="line">		adminSID, err := r.Cookie(<span class="string">&quot;adminSID&quot;</span>) <span class="comment">// 通过Cookie获取adminSID</span></span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Printf(<span class="string">&quot;%+v\n&quot;</span>, err)</span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Println(adminSID.Value)</span><br><span class="line">		adminUid, err := GetAdminSid(adminSID.Value) <span class="comment">// 调用了GetAdminSid</span></span><br><span class="line">		<span class="comment">// 部分源码经过省略 </span></span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		http.NotFound(w, <span class="literal">nil</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>继续跟踪GetAdminSid：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetAdminSid</span><span class="params">(adminSessionCookie <span class="keyword">string</span>)</span> <span class="params">(results <span class="keyword">string</span>, err error)</span></span> &#123;</span><br><span class="line">	commandLine := <span class="string">&quot;mysql -h mysql -u root -prootwolf -e &#x27;select adminsid from vulnapp.adminsessions where adminsessionid=\&quot;&quot;</span> + adminSessionCookie + <span class="string">&quot;\&quot;;&#x27;&quot;</span></span><br><span class="line">	res, err := exec.Command(<span class="string">&quot;sh&quot;</span>, <span class="string">&quot;-c&quot;</span>, commandLine).Output()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(err)</span><br><span class="line">	&#125;</span><br><span class="line">	results = <span class="keyword">string</span>(res)</span><br><span class="line">	<span class="keyword">if</span> results != <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> results, <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line">	err = xerrors.New(<span class="string">&quot;recode was not set&quot;</span>)</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&quot;&quot;</span>, err</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到，commandLine是会被传递到exec.Command命令当中去执行命令，而commandLine中的语句，是直接通过与adminSessionCookie进行拼接得到的，没有经过任何的过滤。所以这里造成了命令执行漏洞。</p>
<p>同样的问题，在admin/confirm.go的也是造成了命令执行漏洞。</p>
<h2 id="CSRF漏洞"><a href="#CSRF漏洞" class="headerlink" title="CSRF漏洞"></a>CSRF漏洞</h2><h3 id="后台多处存在CSRF漏洞"><a href="#后台多处存在CSRF漏洞" class="headerlink" title="后台多处存在CSRF漏洞"></a>后台多处存在CSRF漏洞</h3><p>先来看<code>pkg./user/usermanager.go</code>中的<code>ConfirmPasswdChange</code>函数</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ConfirmPasswdChange</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">	<span class="keyword">if</span> r.Method == <span class="string">&quot;POST&quot;</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> cookie.CheckSessionID(r) &#123;</span><br><span class="line">			<span class="keyword">if</span> r.Referer() == <span class="string">&quot;http://127.0.0.1/profile/changepasswd&quot;</span> &#123;</span><br><span class="line">				<span class="comment">// 接着进行修改密码的操作</span></span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		http.NotFound(w, <span class="literal">nil</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>可以看到，这里是限制了Referer只能为<code>http://127.0.0.1/profile/changepasswd</code>所以这里是没有CSRF的，但是整个后台，除了修改密码处验证了Referer，其他修改内容功能的点都没有验证，因此都存在CSRF漏洞。比如Profie用户信息修改，TimeLine发送留言等。</p>
<p>比如TimeLine发送留言：</p>
<p><img src="https://i.loli.net/2020/02/21/eAwyHt4SPQWZE6N.png" alt="01.png"></p>
<p>直接用Brupsuite构造CSRF的poc即可。</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a target="_blank" rel="noopener" href="https://astaxie.gitbooks.io/build-web-application-with-golang/zh/">Go Web 编程</a></li>
<li><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/8Ju05hYCYk6bOgkvjtP11A">Go语言代码安全审计分享</a></li>
</ul>

    </div>

    
</div>
    <div class="footer" id="footer">
    <p>Copyright © 2020 Threezh1
        <!-- <label class="el-switch el-switch-green el-switch-sm" style="vertical-align: sub;">
            <input type="checkbox" name="switch" id="update_style">
            <span class="el-switch-style"></span>
        </label> -->
<!--         <script type="text/javascript">
        var cnzz_protocol = (("https:" == document.location.protocol) ? "https://" : "http://");
        document.write(unescape("%3Cspan id='cnzz_stat_icon_1278548644'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "v1.cnzz.com/stat.php%3Fid%3D1278548644%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));
        </script> -->
    </p>
</div>
<input type="hidden" id="web_style" value="black">
<input type="hidden" id="valine_appid" value="CmCti21ooOOIzFOhEyFkFvR0-gzGzoHsz">
<input type="hidden" id="valine_appKey" value="FqiyUqbg7McKN2eG0MCewupf">

<script src="/libs/jquery.min.js"></script>


<script src="/libs/highlight/highlight.pack.js"></script>

<script src='//cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js'></script>

<script src="/js/js.js"></script>

<style type="text/css">
.v * {
    color: #698fca;
}

.v .vlist .vcard .vhead .vsys {
    color: #3a3e4a;
}

.v .vlist .vcard .vh .vmeta .vat {
    color: #638fd5;
}

.v .vlist .vcard .vhead .vnick {
    color: #6ba1ff;
}

.v a {
    color: #8696b1;
}

.v .vlist .vcard .vhead .vnick:hover {
    color: #669bfc;
}
</style>
</body>

</html>